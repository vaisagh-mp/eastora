{% extends 'adminpanel/base.html' %}
{% load static %}
{% block content %}



<div class="container">
    <div class="row justify-content-center">
        <div class="add-catgry-col">
            <div class="add-catgry-card">
                <h3 class="add-catgry-title mb-4">Add New Category</h3>
                <form method="POST" class="add-catgry-form" enctype="multipart/form-data"> {% csrf_token %}
                    <!-- Category Name -->
                    <div class="mb-3">
                        <label for="categoryName" class="add-catgry-label">Category Name<span style="color:red">*</span></label>
                        <input type="text" name="categoryname" id="categoryName" class="add-catgry-input"
                            placeholder="Enter category name" required>
                    </div>

                    <!-- Parent Category -->
                    <div class="mb-3">
                        <label for="parentCategory" class="add-catgry-label">Parent Category</label>
                        <select id="parentCategory" name="parentCategory" class="add-catgry-select">
                            <option value="">None</option>
                            {% for category in parent_categories %}
                            <option value="{{ category.id }}">{{ category.name }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="mb-3">
                        <label for="parentChoice" class="add-catgry-label">Parent Choice<span style="color:red">*</span></label>
                        <select id="parentChoice" name="parentChoice" class="add-catgry-select" required>
                            <option value="">Select a tour category</option>
                            <option value="india">India Tours</option>
                            <option value="international">International Tours</option>
                            <option value="ayurveda">Ayurveda & Wellness</option>
                            <option value="specials">Eastora Specials</option>
                        </select>
                    </div>


                    <!-- Category Banner Image (Desktop) -->
                    <div class="mb-3">
                        <label class="add-catgry-label">Category Banner Image (Desktop)<span style="color:red">*</span></label>
                        <input type="file" id="bannerImageDesktop" name="bannerImageDesktop" class="add-catgry-input d-none" accept="image/*">
                        <label for="bannerImageDesktop" class="add-catgry-dropzone" id="bannerDropzoneDesktop">
                            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M3 15a4 4 0 01.88-7.903 5.5 5.5 0 0110.658 2.35h.462A5 5 0 1120 15H3z" />
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M12 12v6m0 0l-2.5-2.5M12 18l2.5-2.5" />
                            </svg>
                            <span id="bannerImageDesktopText">Drag & drop your image or <span class="add-catgry-select-file">Select files</span></span>
                            <img id="bannerImageDesktopPreview" src="" alt="Preview" style="display:none; margin-top: 10px; max-height: 100px;">
                        </label>
                    </div>

                    <!-- Category Banner Image (Mobile) -->
                    <div class="mb-3">
                        <label class="add-catgry-label">Category Banner Image (Mobile)<span style="color:red">*</span></label>
                        <input type="file" id="bannerImageMobile" name="bannerImageMobile" class="add-catgry-input d-none" accept="image/*">
                        <label for="bannerImageMobile" class="add-catgry-dropzone" id="bannerDropzoneMobile">
                            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M3 15a4 4 0 01.88-7.903 5.5 5.5 0 0110.658 2.35h.462A5 5 0 1120 15H3z" />
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M12 12v6m0 0l-2.5-2.5M12 18l2.5-2.5" />
                            </svg>
                            <span id="bannerImageMobileText">Drag & drop your image or <span class="add-catgry-select-file">Select files</span></span>
                            <img id="bannerImageMobilePreview" src="" alt="Preview" style="display:none; margin-top: 10px; max-height: 100px;">
                        </label>
                    </div>


                    <!-- Card Image -->
                    <div class="form-section">
                        <label class="pkg-label">Card Image<span style="color:red">*</span></label>
                        <input type="file" name="card_image" class="pkg-input" required>
                    </div>

                    <!-- Short Description -->
                    <div class="mb-3">
                        <label for="shortDesc" class="add-catgry-label">Short Description <span
                                style="color:red">*</span></label>
                        <input type="text" name="shortDesc" id="shortDesc" class="add-catgry-input"
                            placeholder="Brief description" required minlength="5" maxlength="150">
                    </div>

                    <!-- Long Description -->
                    <div class="mb-4">
                        <label for="longDesc" class="add-catgry-label">Long Description <span
                                style="color:red">*</span></label>
                        <textarea name="longDesc" id="longDescriptionEditor" rows="5" class="add-catgry-textarea"
                            placeholder="Write full description here..."></textarea>
                    </div>

                    <!-- Tittle Name One -->
                    <div class="mb-3">
                        <label for="tittlefirst" class="add-catgry-label">Tittle Name One</label>
                        <input type="text" name="tittlefirst" id="tittlefirst" class="add-catgry-input"
                            placeholder="Enter title first" required>
                    </div>

                    <!-- Content 1 -->
                    <div class="mb-4">
                        <label for="contentfir" class="add-catgry-label">Content 1 <span
                                style="color:red">*</span></label>
                        <textarea name="contentfir" id="Content1" rows="5" class="add-catgry-textarea"
                            placeholder="Write full description here..."></textarea>
                    </div>

                    <!-- Tittle Name two -->
                    <div class="mb-3">
                        <label for="tittlesecond" class="add-catgry-label">Tittle Name two</label>
                        <input type="text" name="tittlesecond" id="tittlesecond" class="add-catgry-input"
                            placeholder="Enter title second" required>
                    </div>

                    <!-- Content 2 -->
                    <div class="mb-4">
                        <label for="contentsec" class="add-catgry-label">Content 2 <span
                                style="color:red">*</span></label>
                        <textarea name="contentsec" id="Content2" rows="5" class="add-catgry-textarea"
                            placeholder="Write full description here..."></textarea>
                    </div>


                    <!-- Recommended -->
                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" name="recomanded" id="recomanded">
                        <label class="form-check-label add-catgry-label" for="recomanded">Recommended</label>
                    </div>


                    <!-- Submit -->
                    <div class="text-center">
                        <button type="submit" class="add-catgry-btn">Add Category</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>


<!-- <script>
    const dropzone = document.getElementById('bannerDropzone');
    const input = document.getElementById('bannerImage');
    const imageText = document.getElementById('bannerImageText');
    const imagePreview = document.getElementById('bannerImagePreview');

    // Highlight on drag
    ['dragenter', 'dragover'].forEach(evt => {
        dropzone.addEventListener(evt, e => {
            e.preventDefault();
            dropzone.classList.add('dragover');
        });
    });

    // Remove highlight on dragleave/drop
    ['dragleave', 'drop'].forEach(evt => {
        dropzone.addEventListener(evt, e => {
            e.preventDefault();
            dropzone.classList.remove('dragover');
        });
    });

    // Open file dialog on click
    dropzone.addEventListener('click', () => input.click());

    // When file is dropped
    dropzone.addEventListener('drop', e => {
        e.preventDefault();
        input.files = e.dataTransfer.files;
        handleImagePreview(input.files[0]);
    });

    // When file is selected manually
    input.addEventListener('change', () => {
        handleImagePreview(input.files[0]);
    });

    function handleImagePreview(file) {
        if (file && file.type.startsWith('image/')) {
            const reader = new FileReader();
            reader.onload = function (e) {
                imagePreview.src = e.target.result;
                imagePreview.style.display = 'block';
                imageText.innerHTML = `<strong>${file.name}</strong> selected.`;
            };
            reader.readAsDataURL(file);
        } else {
            imageText.innerHTML = 'Invalid file type. Please select an image.';
            imagePreview.style.display = 'none';
        }
    }
</script> -->


<script>
function setupDropzone(inputId, dropzoneId, textId, previewId) {
    const dropzone = document.getElementById(dropzoneId);
    const input = document.getElementById(inputId);
    const imageText = document.getElementById(textId);
    const imagePreview = document.getElementById(previewId);

    ['dragenter', 'dragover'].forEach(evt => {
        dropzone.addEventListener(evt, e => {
            e.preventDefault();
            dropzone.classList.add('dragover');
        });
    });

    ['dragleave', 'drop'].forEach(evt => {
        dropzone.addEventListener(evt, e => {
            e.preventDefault();
            dropzone.classList.remove('dragover');
        });
    });

    dropzone.addEventListener('click', () => input.click());

    dropzone.addEventListener('drop', e => {
        e.preventDefault();
        input.files = e.dataTransfer.files;
        handleImagePreview(input.files[0]);
    });

    input.addEventListener('change', () => {
        handleImagePreview(input.files[0]);
    });

    function handleImagePreview(file) {
        if (file && file.type.startsWith('image/')) {
            const reader = new FileReader();
            reader.onload = function (e) {
                imagePreview.src = e.target.result;
                imagePreview.style.display = 'block';
                imageText.innerHTML = `<strong>${file.name}</strong> selected.`;
            };
            reader.readAsDataURL(file);
        } else {
            imageText.innerHTML = 'Invalid file type. Please select an image.';
            imagePreview.style.display = 'none';
        }
    }
}

// Setup both desktop & mobile
setupDropzone("bannerImageDesktop", "bannerDropzoneDesktop", "bannerImageDesktopText", "bannerImageDesktopPreview");
setupDropzone("bannerImageMobile", "bannerDropzoneMobile", "bannerImageMobileText", "bannerImageMobilePreview");
</script>

<script src="https://cdn.ckeditor.com/ckeditor5/41.1.0/classic/ckeditor.js"></script>
<!-- CK Text Editor -->
 <script>
  ClassicEditor
    .create(document.querySelector('#longDescriptionEditor'))
    .then(editor => {
      editor.ui.view.editable.element.style.height = '250px';
    })
    .catch(error => {
      console.error('There was a problem initializing CKEditor:', error);
 });
</script>

 <script>
  ClassicEditor
    .create(document.querySelector('#Content1'))
    .then(editor => {
      editor.ui.view.editable.element.style.height = '250px';
    })
    .catch(error => {
      console.error('There was a problem initializing CKEditor:', error);
 });
</script>

 <script>
  ClassicEditor
    .create(document.querySelector('#Content2'))
    .then(editor => {
      editor.ui.view.editable.element.style.height = '250px';
    })
    .catch(error => {
      console.error('There was a problem initializing CKEditor:', error);
 });
</script>
{% endblock %}